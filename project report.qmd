# Introduction

Air pollution is not only an environmental concern, but also a public health one. There is substantial evidence that indicates a link in adverse health outcomes, including an increase in mortality rates. Using quantitative analysis, statisticians in the past have been able to determine the exact link as well as use a multitude of methods to study these results.

One example is seen in the article titled: *"Instabilities of Regression Estimates Relating Air Pollution to Mortality"*. The article aimed to explore the relationship between air pollution and mortality rates with the use of regression-based estimates. The authors use a various number of factors, such as rain, temperature, different levels of toxic chemicals, to determine a linear model between air pollution and mortality rates. They used ridge regression to create better coefficient estimates due to the underlying issues the data faced.

## Objective

The purpose of this report is to replicate the analyses that were conducted in the original study, using techniques that we have discussed in this class, as well as the use of modern technology. An important note is that the article was written in the 1970s, and the data and statistical methods were most likely conducted during that time. We are aware of the advanced technology we have now, and we hope to compare our output versus the original output, and perhaps observe better results. We also hope to learn more about statistical modeling as well as contribute to a better understanding of how methodologies change over time. Finally, we hope to truly understand and do our best to interpret the relationship between air pollution and mortality rates.

# Literature Review

# Methodology From Author

## Data Description

## Regression Models

## Assumptions

## Reproduction Plan

# Implementation

## Exploratory Data Analysis

```{r}
# pulling the data
library("bestglm")
data <- mcdonald

head(data)
```
```{r}
#Distribution of respose variable
ggplot(data, aes(x = MORT)) +
  geom_histogram(binwidth = 50, fill = "skyblue", color = "black") +
  labs(
    title = "Distribution of Mortality Rates",
    x = "Mortality",
    y = "Frequency"
  ) +
  theme_minimal()
```



```{r}
# Scatterplot: Mortality vs. Pollution Variables
hc <- ggplot(data, aes(x = HC, y = MORT)) +
  geom_point(color = "blue") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(
    title = "Mortality vs. Hydrocarbon Pollution",
    x = "Hydrocarbon Pollution Potential",
    y = "Mortality"
  ) +
  theme_minimal()

nox <- ggplot(data, aes(x = NOX, y = MORT)) +
  geom_point(color = "blue") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(
    title = "Mortality vs. NoX Pollution",
    x = "Hydrocarbon Pollution Potential",
    y = "Mortality"
  ) +
  theme_minimal()

so2 <- ggplot(data, aes(x = SOx, y = MORT)) +
  geom_point(color = "blue") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(
    title = "Mortality vs. SO2 Pollution",
    x = "Hydrocarbon Pollution Potential",
    y = "Mortality"
  ) +
  theme_minimal()

library(ggpubr)
ggarrange(
  hc,nox,so2
)
```
```{r}
# correlation heat map
library(reshape2)

# Calculate correlation matrix
cor_matrix <- cor(data)
cor_data <- melt(cor_matrix)

# Heatmap
ggplot(cor_data, aes(Var1, Var2, fill = value)) +
  geom_tile(color = "white") +
  scale_fill_gradient2(
    low = "blue", high = "red", mid = "white",
    midpoint = 0, limit = c(-1, 1)
  ) +
  labs(title = "Correlation Heatmap", x = "", y = "") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```




## Multiple Linear Regression
```{r}
#first full model
ols_model <- lm(MORT ~., data = data)
summary(ols_model)
```
```{r}
ggplot(data = data.frame(
  residuals = residuals(ols_model),
  fitted = fitted(ols_model)
), aes(x = fitted, y = residuals)) +
  geom_point() +
  geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
  labs(
    title = "Residuals vs. Fitted Values",
    x = "Fitted Values",
    y = "Residuals"
  ) +
  theme_minimal()
```


### Mallow's $C_p$

```{r}
#plotting mallow's Cp

library(ggplot2)  # For plotting
library(leaps)    # For all subset regression

# str(data)

```


```{r}
#subset the modeling using stepAIC, or the Akaike Information Criterion
library(MASS)
ols_aic <- stepAIC(ols_model, direction = "both", trace = FALSE)
summary(ols_aic)
```
```{r}
# get the AIC for Cp Mallows then compare with stepAIC, full, and CP Mallows

```
Mallow's C_p performs slightly better 

## Ridge Regression

# Results

## Comparison of Outputs

```{r}
# want to compare the AIC, ridge regression, CP Mallow, and PCA to the full model 
```


## Deviations

## Interpreting the Results

# Challenges and Insights

## Challenges

## Insights

# Conclusion

## Significance

## Summary

## Future Work

## Acknowledgements

# References
